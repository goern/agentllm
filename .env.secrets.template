# Environment Secrets Template
# This file contains sensitive values and environment-specific configuration.
#
# FOR LOCAL DEVELOPMENT:
# 1. Copy this file to .env.secrets
# 2. Fill in your actual values
# 3. NEVER commit .env.secrets (it's in .gitignore)
#
# FOR PRODUCTION:
# These values are stored in Kubernetes Secrets and injected via envFrom.
# See: rhdh-sidekick-infra/manifests/sidekick/overlays/prod/secrets.yaml

# ============================================================================
# API Keys and Authentication
# ============================================================================

# Google Gemini API Key (Required)
# This single key is used for:
# - Direct Gemini 2.5 models (gemini-2.5-pro, gemini-2.5-flash)
# - Agno agents (echo, assistant, code-helper, release-manager)
# Get your key from: https://aistudio.google.com/apikey
GEMINI_API_KEY=AIzaSy...

# LiteLLM Proxy Master Key
# API key for accessing the LiteLLM proxy
# Default for local dev (change in production!)
LITELLM_MASTER_KEY=sk-agno-test-key-12345

# ============================================================================
# Token Encryption (REQUIRED)
# ============================================================================

# Fernet encryption key for token storage
# All API tokens (Jira, GitHub, Google Drive, RHCP) are encrypted at rest
# in the SQLite database using this key.
#
# Generate a new key:
#   python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
#
# Example output: eSsSRZhHEmUJyrC43OFHUed0fDjhrKtTaDWQKVZpRRY=
#
# IMPORTANT:
# - Keep this key SECRET and SECURE
# - Store in Kubernetes Secret in production (never commit to git)
# - If key is lost, all stored tokens become unrecoverable (users must re-enter)
# - Changing this key invalidates all existing tokens
# - For local development, generate once and reuse to avoid re-entering tokens
#
# Local development (generate once and keep in .env.secrets):
AGENTLLM_TOKEN_ENCRYPTION_KEY=your-generated-key-here
#
# Production: Set via Kubernetes Secret (see docs/deployment-encryption.md)

# ============================================================================
# Google OAuth for User Authentication (Optional)
# ============================================================================
# Open WebUI Google OAuth - for user login to the web interface
# To enable Google sign-in for Open WebUI users:
# 1. In Google Cloud Console > "APIs & Services" > "Credentials"
# 2. Select your OAuth 2.0 Client ID (or create a new one)
# 3. Add authorized redirect URI for local dev:
#    http://localhost:9500/oauth/oidc/callback
#    (or your production domain)
# 4. Copy the client_id and client_secret:
OAUTH_CLIENT_ID=your_client_id_here.apps.googleusercontent.com
OAUTH_CLIENT_SECRET=your_client_secret_here

# ============================================================================
# Google Drive OAuth (Optional)
# ============================================================================
# For Release Manager agent's Google Drive toolkit integration
# This enables the agent to read/write Google Drive files.
#
# Setup:
# 1. Go to https://console.cloud.google.com
# 2. Create a new project or select an existing one
# 3. Enable the Google Drive API:
#    - Navigate to "APIs & Services" > "Library"
#    - Search for "Google Drive API" and enable it
# 4. Create OAuth 2.0 credentials:
#    - Go to "APIs & Services" > "Credentials"
#    - Click "Create Credentials" > "OAuth 2.0 Client ID"
#    - Application type: "Web application"
#    - Add authorized redirect URIs:
#      For local dev with OAuth callback server: http://localhost:9502/agentllm/oauth/callback/google
#      For production: https://your-domain.com/agentllm/oauth/callback/google
#    - Click "Create"
# 5. Copy the client_id and client_secret:
GDRIVE_CLIENT_ID=your_client_id_here.apps.googleusercontent.com
GDRIVE_CLIENT_SECRET=your_client_secret_here

# AgentLLM OAuth Callback Server Base URL (Optional)
# When set, enables automated OAuth callback handling for agent features
# (Google Drive, GitHub, etc.) - recommended for production
# When not set, falls back to manual code paste workflow (legacy local dev mode)
#
# NOTE: This is different from OAUTH_REDIRECT_URI (Open WebUI user login)!
#       This is for agent OAuth features, not web UI authentication.
#
# Local development with OAuth callback server (default for just dev):
#   AGENTLLM_OAUTH_CALLBACK_BASE_URL=http://localhost:9502
#
# Production (Kubernetes/OpenShift):
#   AGENTLLM_OAUTH_CALLBACK_BASE_URL=https://oauth.apps.your-cluster.com
#
# Legacy local dev (manual code paste - no callback server):
#   Leave unset or comment out
AGENTLLM_OAUTH_CALLBACK_BASE_URL=http://localhost:9502

# ============================================================================
# Google Drive Service Account (Optional - Alternative to OAuth)
# ============================================================================
# For server-to-server Google Drive access without per-user OAuth flows.
# Use this instead of GDRIVE_CLIENT_ID/SECRET when you want:
# - Access to shared team documents
# - System-level document access (e.g., Release Manager system prompts)
# - No per-user authorization required
#
# Setup (see docs/google_service_account_setup.md for detailed guide):
# 1. Create service account in Google Cloud Console
# 2. Download JSON key file
# 3. Share documents with service account email
# 4. Set ONE of the following environment variables:
#
# Option 1 (Recommended): Path to JSON key file
GDRIVE_SERVICE_ACCOUNT_PATH=secrets/gdrive-service-account.json
#
# Option 2 (Alternative): Embedded JSON string (useful for some deployment platforms)
# GDRIVE_SERVICE_ACCOUNT_JSON='{"type":"service_account","project_id":"...","private_key":"..."}'
#
# Note: If both OAuth (CLIENT_ID/SECRET) and Service Account are configured,
#       the agent can use both - OAuth for user documents, Service Account for shared docs.

# ============================================================================
# Release Manager Extended System Prompt (Optional)
# ============================================================================
# Google Doc URL or ID containing extended agent instructions
# This supplements the embedded system prompt with dynamic operational content
# (Jira query patterns, response templates, communication guidelines)
#
# Setup: Copy docs/templates/release_manager_system_prompt.md to a Google Drive document
#        and set this variable to the document URL or ID
#
# Requirements:
# - User must have Google Drive configured (GDRIVE_CLIENT_ID/SECRET above)

# ============================================================================
# Knowledge Base / RAG Vector Storage
# ============================================================================
# Knowledge base configuration is now handled per-agent via code.
# Each agent specifies its knowledge_path and table_name in its configurator's
# _get_knowledge_config() method.
#
# Vector DB storage location uses: ${AGENTLLM_DATA_DIR}/lancedb
# In containers: /app/tmp/lancedb
# No environment variables needed for knowledge configuration.
RELEASE_MANAGER_SYSTEM_PROMPT_GDRIVE_URL=

# ============================================================================
# RHDH Support Agent Extended System Prompt (Optional)
# ============================================================================
# Google Doc URL or ID containing extended agent instructions
# This supplements the embedded system prompt with dynamic operational content
# (JQL query patterns, severity mapping, escalation procedures, team assignments)
#
# Setup: Copy docs/templates/rhdh_support_system_prompt.md to a Google Drive document
#        and set this variable to the document URL or ID
#
# Requirements:
# - User must have Google Drive configured (GDRIVE_CLIENT_ID/SECRET above)
# - User must have read access to the specified Google Doc
# - Content is fetched once and cached per user until agent invalidation
#
# Example values:
# - Full URL: https://docs.google.com/document/d/1ABC123xyz/edit
# - Document ID only: 1ABC123xyz
SUPPORT_AGENT_SYSTEM_PROMPT_GDRIVE_URL=

# ============================================================================
# Jira Triager Configuration
# ============================================================================

# Requirements:
# - User must have Google Drive configured (GDRIVE_CLIENT_ID/SECRET above)
# - User must have read access to the specified Google Doc
# - Content is fetched once and cached per user until agent invalidation
#
# Google Doc URL or ID containing triage behavior guidelines
# This defines how the agent scores confidence and handles special cases.
#
# Example values:
# - Full URL: https://docs.google.com/document/d/1ABC123xyz/edit
# - Document ID only: 1ABC123xyz
JIRA_TRIAGER_SYSTEM_PROMPT_GDRIVE_URL=
#
# Google Drive folder ID containing configuration files
# This folder must contain:
# - rhdh-teams.json (team IDs, components, members)
# - jira-filter.txt (default JQL filter for batch triage)
JIRA_TRIAGER_GDRIVE_FOLDER_ID=
#
# Note: Requires Google Drive OAuth credentials (configured above in "Google Drive OAuth" section)

# ============================================================================
# Environment-Specific Configuration
# ============================================================================

# OpenAI API Base URL (how Open WebUI connects to LiteLLM proxy)
#
# RECOMMENDED (just dev - both containerized):
#   OPENAI_API_BASE_URL=http://litellm-proxy:8890/v1
#
# Local proxy mode (just proxy in terminal, OpenWebUI in container):
#   OPENAI_API_BASE_URL=http://host.containers.internal:9501/v1
#
# Production (Kubernetes):
#   OPENAI_API_BASE_URL=http://litellm-proxy-service:8890/v1
#
# Note: Internal container port is always 8890, external host port is 9501
OPENAI_API_BASE_URL=http://litellm-proxy:8890/v1

# WebUI branding and URLs (environment-specific)
# Local development
WEBUI_NAME=Sidekick Agent (Local)
WEBUI_URL=http://localhost:9500

# Production values (set in Kubernetes Secret, auto-configured by deploy.sh):
# WEBUI_NAME=Sidekick Agent
# WEBUI_URL=https://sidekick.apps.your-cluster.com
# OAUTH_REDIRECT_URI=https://sidekick.apps.your-cluster.com/oauth/oidc/callback

# ============================================================================
# Logging and Debug Configuration (Environment-Specific)
# ============================================================================

# Logging levels (local development uses DEBUG, production uses INFO)
LOG_LEVEL=DEBUG
UVICORN_LOG_LEVEL=debug
GLOBAL_LOG_LEVEL=DEBUG

# WebUI Debug mode (local development only)
WEBUI_DEBUG=true

# ============================================================================
# Security Settings (Environment-Specific)
# ============================================================================

# Cookie security settings
# Local development (HTTP): set to false
# Production (HTTPS): set to true
WEBUI_SESSION_COOKIE_SECURE=false
WEBUI_AUTH_COOKIE_SECURE=false

# WebUI Secret Key (should be random and persistent in production)
# Production should generate a random value
WEBUI_SECRET_KEY=change-this-to-a-random-secret-key-for-production

# ============================================================================
# Production-Only Variables (Not used in local development)
# ============================================================================
# These are set by deploy scripts in production environments:
#
# OAUTH_REDIRECT_URI - Auto-configured from OpenShift route
# Environment mode (local doesn't set this, production uses "prod")
# ENV=prod

# ============================================================================
# Agent-Specific Configuration
# ============================================================================

# Release Manager agent - Google Sheet ID for release data
AGENTLLM_RHAI_ROADMAP_PUBLISHER_RELEASE_SHEET=your_google_sheet_url_here
